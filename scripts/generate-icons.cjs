const fs = require('fs');
const path = require('path');

// Minimal 1x1 PNG (smallest valid PNG)
const minPng = Buffer.from([
  0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, // PNG signature
  0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52, // IHDR chunk
  0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, // 1x1 dimensions
  0x08, 0x02, 0x00, 0x00, 0x00, 0x90, 0x77, 0x53, 0xDE,
  0x00, 0x00, 0x00, 0x0C, 0x49, 0x44, 0x41, 0x54, // IDAT chunk
  0x08, 0xD7, 0x63, 0xF8, 0xCF, 0xC0, 0x00, 0x00,
  0x00, 0x03, 0x00, 0x01, 0x00, 0x18, 0xDD, 0x8D, 0xB4,
  0x00, 0x00, 0x00, 0x00, 0x49, 0x45, 0x4E, 0x44, // IEND chunk
  0xAE, 0x42, 0x60, 0x82
]);

// Minimal ICO file (16x16)
const minIco = Buffer.from([
  0x00, 0x00, // Reserved
  0x01, 0x00, // Type (1 = ICO)
  0x01, 0x00, // Number of images
  0x10, // Width (16)
  0x10, // Height (16)
  0x00, // Color palette
  0x00, // Reserved
  0x01, 0x00, // Color planes
  0x20, 0x00, // Bits per pixel (32)
  0x68, 0x04, 0x00, 0x00, // Size of image data
  0x16, 0x00, 0x00, 0x00, // Offset to image data
  // Minimal BMP header and data follows...
  0x28, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
  0x20, 0x00, 0x00, 0x00, 0x01, 0x00, 0x20, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
]);

// Add pixel data for ICO (16x16 RGBA = 1024 bytes, all purple-ish)
const icoPixels = Buffer.alloc(1024);
for (let i = 0; i < 1024; i += 4) {
  icoPixels[i] = 0x60;     // B
  icoPixels[i + 1] = 0x45; // G
  icoPixels[i + 2] = 0xe9; // R (accent color)
  icoPixels[i + 3] = 0xff; // A
}

// AND mask for ICO (16x16 / 8 bits * height = 32 bytes, all zeros = fully visible)
const icoMask = Buffer.alloc(64, 0x00);

const fullIco = Buffer.concat([minIco, icoPixels, icoMask]);

const iconsDir = path.join(__dirname, '..', 'src-tauri', 'icons');

// Create directory if it doesn't exist
if (!fs.existsSync(iconsDir)) {
  fs.mkdirSync(iconsDir, { recursive: true });
}

// Write placeholder icons
fs.writeFileSync(path.join(iconsDir, '32x32.png'), minPng);
fs.writeFileSync(path.join(iconsDir, '128x128.png'), minPng);
fs.writeFileSync(path.join(iconsDir, '128x128@2x.png'), minPng);
fs.writeFileSync(path.join(iconsDir, 'icon.ico'), fullIco);
fs.writeFileSync(path.join(iconsDir, 'icon.icns'), minPng); // macOS will need proper icns

console.log('Placeholder icons created in', iconsDir);
